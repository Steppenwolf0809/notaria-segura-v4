# Env Cleanup Plan (Safe)

This plan proposes non-breaking steps. No code changes applied.

## Keep

- ADVANCED_EXTRACTION
- ALLOWED_ORIGINS
- ALLOWED_ORIGINS_DEV
- API_SECRET_KEY
- API_URL
- APP_TIMEZONE
- BACKEND_URL
- CACHE_ENABLED
- CACHE_TTL_MS
- CAJA_DOCS_LIMIT_DEFAULT
- CONCUERDOS_OCR_FIRST
- DATABASE_URL
- DEBUG_EXTRACTION_METHOD
- DEFAULT_EXTRACTION_CONFIDENCE
- DEV
- FRONTEND_URL
- GEMINI_CIRCUIT_THRESHOLD
- GEMINI_CIRCUIT_TIMEOUT
- GEMINI_ENABLED
- GEMINI_JSON_MODE
- GEMINI_MAX_RETRIES
- GEMINI_MAX_RETRY_DELAY
- GEMINI_MODEL
- GEMINI_RETRY_DELAY
- GEMINI_TIMEOUT
- GOOGLE_API_KEY
- JWT_EXPIRES_IN
- JWT_SECRET
- LLM_ROUTER_ENABLED
- LLM_STRATEGY
- NEXT_PUBLIC_DOCS_ARCHIVO_TABS
- NEXT_PUBLIC_DOCS_LAZY_DELIVERED
- NEXT_PUBLIC_DOCS_MATRIZADOR_TABS
- NEXT_PUBLIC_DOCS_RECEPCION_GROUPED
- NEXT_PUBLIC_DOCS_SEARCH_SMART_SCOPE
- NEXT_PUBLIC_DOCS_SEARCH_TOGGLE_RECEPCION
- NEXT_PUBLIC_DOCS_WINDOWING
- NODE_ENV
- NOTARIA_CONTACTO
- NOTARIA_DIRECCION
- NOTARIA_HORARIO
- NOTARIA_NOMBRE
- OCR_CACHE_TTL_MS
- OCR_ENABLED
- OCR_LANGS
- OCR_MAX_PAGES
- OCR_PSM
- PDF_EXTRACTOR_BASE_URL
- PDF_EXTRACTOR_ENABLED
- PDF_EXTRACTOR_TIMEOUT
- PDF_EXTRACTOR_TOKEN
- PDF_OCR_DPI
- PDF_USE_PDFTOTEXT
- PORT
- PROMPT_FORCE_TEMPLATE
- RAILWAY_PUBLIC_DOMAIN
- REDIS_HOST
- REDIS_PASSWORD
- REDIS_PORT
- REDIS_URL
- SERVICE_EMAIL
- SERVICE_PASSWORD
- SLOW_REQUEST_MS
- STRUCTURE_ROUTER_ENABLED
- TEMPLATE_MODE
- TWILIO_ACCOUNT_SID
- TWILIO_AUTH_TOKEN
- TWILIO_PHONE_NUMBER
- TWILIO_WHATSAPP_FROM
- TZ
- VITE_API_BASE_URL
- VITE_API_URL
- VITE_DOCS_ARCHIVO_TABS
- VITE_DOCS_LAZY_DELIVERED
- VITE_DOCS_MATRIZADOR_TABS
- VITE_DOCS_RECEPCION_GROUPED
- VITE_DOCS_SEARCH_SMART_SCOPE
- VITE_DOCS_SEARCH_TOGGLE_RECEPCION
- VITE_DOCS_WINDOWING
- WHATSAPP_ASYNC
- WHATSAPP_ENABLED
- XML_WATCHER_ENABLED

## Deprecate + Migration

- CONCUERDOS_USE_GEMINI_FIRST: Replace with LLM_STRATEGY presets. Suggested mapping: 
  - CONCUERDOS_USE_GEMINI_FIRST=true -> LLM_STRATEGY=gemini 
  - CONCUERDOS_USE_GEMINI_FIRST=false -> LLM_STRATEGY=default
- EXTRACT_HYBRID: Replace with LLM_STRATEGY presets. Suggested mapping: 
  - EXTRACT_HYBRID=true -> LLM_STRATEGY=gemini 
  - EXTRACT_HYBRID=false -> LLM_STRATEGY=default
- FORCE_PYTHON_EXTRACTOR: Replace with LLM_STRATEGY presets. Suggested mapping: 
  - FORCE_PYTHON_EXTRACTOR=true -> LLM_STRATEGY=gemini 
  - FORCE_PYTHON_EXTRACTOR=false -> LLM_STRATEGY=default
- GEMINI_PRIORITY: Replace with LLM_STRATEGY presets. Suggested mapping: 
  - GEMINI_PRIORITY=true -> LLM_STRATEGY=gemini 
  - GEMINI_PRIORITY=false -> LLM_STRATEGY=default

Also ensure documentation states these are superseded by `LLM_STRATEGY`.

## Add to .env examples

- .env.example: ADVANCED_EXTRACTION, ALLOWED_ORIGINS, ALLOWED_ORIGINS_DEV, API_SECRET_KEY, API_URL, APP_TIMEZONE, BACKEND_URL, CACHE_ENABLED, CACHE_TTL_MS, CAJA_DOCS_LIMIT_DEFAULT, CIRCUIT_BREAKER_THRESHOLD, CONCUERDOS_OCR_FIRST, CONCUERDOS_USE_GEMINI_FIRST, DATABASE_PUBLIC_URL, DATABASE_URL, DEBUG_EXTRACTION_METHOD, DEFAULT_EXTRACTION_CONFIDENCE, EXTRACT_HYBRID, FORCE_PYTHON_EXTRACTOR, FRONTEND_URL, GEMINI_CIRCUIT_THRESHOLD, GEMINI_CIRCUIT_TIMEOUT, GEMINI_ENABLED, GEMINI_JSON_MODE, GEMINI_MAX_RETRIES, GEMINI_MAX_RETRY_DELAY, GEMINI_MODEL, GEMINI_PRIORITY, GEMINI_RETRY_DELAY, GEMINI_TIMEOUT, GOOGLE_API_KEY, JWT_EXPIRES_IN, JWT_SECRET, LLM_ROUTER_ENABLED, LLM_STRATEGY, NEXT_PUBLIC_DOCS_ARCHIVO_TABS, NEXT_PUBLIC_DOCS_LAZY_DELIVERED, NEXT_PUBLIC_DOCS_MATRIZADOR_TABS, NEXT_PUBLIC_DOCS_RECEPCION_GROUPED, NEXT_PUBLIC_DOCS_SEARCH_SMART_SCOPE, NEXT_PUBLIC_DOCS_SEARCH_TOGGLE_RECEPCION, NEXT_PUBLIC_DOCS_WINDOWING, NODE_ENV, NOTARIA_CONTACTO, NOTARIA_DIRECCION, NOTARIA_HORARIO, NOTARIA_NOMBRE, OCR_CACHE_TTL_MS, OCR_ENABLED, OCR_LANGS, OCR_MAX_PAGES, OCR_PSM, PDF_EXTRACTOR_BASE_URL, PDF_EXTRACTOR_ENABLED, PDF_EXTRACTOR_TIMEOUT, PDF_EXTRACTOR_TOKEN, PDF_OCR_DPI, PDF_USE_PDFTOTEXT, PORT, PROMPT_FORCE_TEMPLATE, RAILWAY_PUBLIC_DOMAIN, RAILWAY_START_COMMAND, RATE_LIMIT_MAX, RATE_LIMIT_WINDOW_MS, REDIS_HOST, REDIS_PASSWORD, REDIS_PORT, REDIS_URL, RETRY_MAX_ATTEMPTS, RUN_MIGRATIONS_ON_START, SERVICE_EMAIL, SERVICE_PASSWORD, SLOW_REQUEST_MS, STRUCTURE_ROUTER_ENABLED, TEMPLATE_CACHE_TTL_MS, TEMPLATE_MODE, TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN, TWILIO_PHONE_NUMBER, TWILIO_WHATSAPP_FROM, TZ, VITE_API_URL, VITE_DOCS_ARCHIVO_TABS, VITE_DOCS_LAZY_DELIVERED, VITE_DOCS_MATRIZADOR_TABS, VITE_DOCS_RECEPCION_GROUPED, VITE_DOCS_SEARCH_SMART_SCOPE, VITE_DOCS_SEARCH_TOGGLE_RECEPCION, VITE_DOCS_WINDOWING, WHATSAPP_ASYNC, WHATSAPP_ENABLED, XML_WATCHER_ENABLED
- .env.staging.example: ADVANCED_EXTRACTION, ALLOWED_ORIGINS, ALLOWED_ORIGINS_DEV, API_SECRET_KEY, API_URL, APP_TIMEZONE, BACKEND_URL, CACHE_ENABLED, CACHE_TTL_MS, CAJA_DOCS_LIMIT_DEFAULT, CIRCUIT_BREAKER_THRESHOLD, CONCUERDOS_OCR_FIRST, CONCUERDOS_USE_GEMINI_FIRST, DATABASE_PUBLIC_URL, DATABASE_URL, DEBUG_EXTRACTION_METHOD, DEFAULT_EXTRACTION_CONFIDENCE, EXTRACT_HYBRID, FORCE_PYTHON_EXTRACTOR, FRONTEND_URL, GEMINI_CIRCUIT_THRESHOLD, GEMINI_CIRCUIT_TIMEOUT, GEMINI_ENABLED, GEMINI_JSON_MODE, GEMINI_MAX_RETRIES, GEMINI_MAX_RETRY_DELAY, GEMINI_MODEL, GEMINI_PRIORITY, GEMINI_RETRY_DELAY, GEMINI_TIMEOUT, GOOGLE_API_KEY, JWT_EXPIRES_IN, JWT_SECRET, LLM_ROUTER_ENABLED, LLM_STRATEGY, NEXT_PUBLIC_DOCS_ARCHIVO_TABS, NEXT_PUBLIC_DOCS_LAZY_DELIVERED, NEXT_PUBLIC_DOCS_MATRIZADOR_TABS, NEXT_PUBLIC_DOCS_RECEPCION_GROUPED, NEXT_PUBLIC_DOCS_SEARCH_SMART_SCOPE, NEXT_PUBLIC_DOCS_SEARCH_TOGGLE_RECEPCION, NEXT_PUBLIC_DOCS_WINDOWING, NODE_ENV, NOTARIA_CONTACTO, NOTARIA_DIRECCION, NOTARIA_HORARIO, NOTARIA_NOMBRE, OCR_CACHE_TTL_MS, OCR_ENABLED, OCR_LANGS, OCR_MAX_PAGES, OCR_PSM, PDF_EXTRACTOR_BASE_URL, PDF_EXTRACTOR_ENABLED, PDF_EXTRACTOR_TIMEOUT, PDF_EXTRACTOR_TOKEN, PDF_OCR_DPI, PDF_USE_PDFTOTEXT, PORT, PROMPT_FORCE_TEMPLATE, RAILWAY_PUBLIC_DOMAIN, RAILWAY_START_COMMAND, RATE_LIMIT_MAX, RATE_LIMIT_WINDOW_MS, REDIS_HOST, REDIS_PASSWORD, REDIS_PORT, REDIS_URL, RETRY_MAX_ATTEMPTS, RUN_MIGRATIONS_ON_START, SERVICE_EMAIL, SERVICE_PASSWORD, SLOW_REQUEST_MS, STRUCTURE_ROUTER_ENABLED, TEMPLATE_CACHE_TTL_MS, TEMPLATE_MODE, TWILIO_ACCOUNT_SID, TWILIO_AUTH_TOKEN, TWILIO_PHONE_NUMBER, TWILIO_WHATSAPP_FROM, TZ, VITE_API_URL, VITE_DOCS_ARCHIVO_TABS, VITE_DOCS_LAZY_DELIVERED, VITE_DOCS_MATRIZADOR_TABS, VITE_DOCS_RECEPCION_GROUPED, VITE_DOCS_SEARCH_SMART_SCOPE, VITE_DOCS_SEARCH_TOGGLE_RECEPCION, VITE_DOCS_WINDOWING, WHATSAPP_ASYNC, WHATSAPP_ENABLED, XML_WATCHER_ENABLED

## Frontend-only vars

- DEV (frontend service .env, exposed at build)
- NEXT_PUBLIC_DOCS_ARCHIVO_TABS (frontend service .env, exposed at build)
- NEXT_PUBLIC_DOCS_LAZY_DELIVERED (frontend service .env, exposed at build)
- NEXT_PUBLIC_DOCS_MATRIZADOR_TABS (frontend service .env, exposed at build)
- NEXT_PUBLIC_DOCS_RECEPCION_GROUPED (frontend service .env, exposed at build)
- NEXT_PUBLIC_DOCS_SEARCH_SMART_SCOPE (frontend service .env, exposed at build)
- NEXT_PUBLIC_DOCS_SEARCH_TOGGLE_RECEPCION (frontend service .env, exposed at build)
- NEXT_PUBLIC_DOCS_WINDOWING (frontend service .env, exposed at build)
- VITE_API_BASE_URL (frontend service .env, exposed at build)
- VITE_API_URL (frontend service .env, exposed at build)
- VITE_DOCS_ARCHIVO_TABS (frontend service .env, exposed at build)
- VITE_DOCS_LAZY_DELIVERED (frontend service .env, exposed at build)
- VITE_DOCS_MATRIZADOR_TABS (frontend service .env, exposed at build)
- VITE_DOCS_RECEPCION_GROUPED (frontend service .env, exposed at build)
- VITE_DOCS_SEARCH_SMART_SCOPE (frontend service .env, exposed at build)
- VITE_DOCS_SEARCH_TOGGLE_RECEPCION (frontend service .env, exposed at build)
- VITE_DOCS_WINDOWING (frontend service .env, exposed at build)

## Additional Notes

- No high-severity findings